<section class="page menu">

  <header class="page-header">
    <h1 class="page-title">Menu</h1>
    <p class="page-subtitle">Personalize your experience</p>
  </header>

  <!-- Section: General -->
  <h3 class="menu-section-header">General</h3>
  <div class="menu-list">
    <!-- Theme Toggle -->
    <div class="menu-item" id="theme-toggle">
      <div class="menu-item-left">
        <i data-lucide="moon" class="menu-icon"></i>
        <div class="menu-info">
          <span class="menu-label">Dark Mode</span>
          <p class="menu-description">Adjust for better night viewing</p>
        </div>
      </div>
      <div class="toggle-switch"></div>
    </div>
  </div>

  <!-- Section: Worship -->
  <h3 class="menu-section-header">Worship</h3>
  <div class="menu-list">
    <!-- Prayer Settings -->
    <button class="menu-item" id="prayer-settings-btn"
      style="background: none; border: none; cursor: pointer; width: 100%; text-align: left;">
      <div class="menu-item-left">
        <i data-lucide="settings" class="menu-icon"></i>
        <div class="menu-info">
          <span class="menu-label">Prayer Settings</span>
          <p class="menu-description" id="menu-prayer-settings-desc">Location • Calculation</p>
        </div>
      </div>
      <i data-lucide="chevron-right" class="menu-icon"></i>
    </button>

    <!-- Notifications -->
    <button class="menu-item" id="notifications-btn"
      style="background: none; border: none; cursor: pointer; width: 100%; text-align: left;">
      <div class="menu-item-left">
        <i data-lucide="bell" class="menu-icon"></i>
        <div class="menu-info">
          <span class="menu-label">Notifications</span>
          <p class="menu-description">Adhan alerts & reminders</p>
        </div>
      </div>
      <i data-lucide="chevron-right" class="menu-icon"></i>
    </button>
  </div>

  <!-- Section: System -->
  <h3 class="menu-section-header">System</h3>
  <div class="menu-list">
    <!-- Clear Cache -->
    <button class="menu-item" id="clear-cache-btn"
      style="background: none; border: none; cursor: pointer; width: 100%; text-align: left;">
      <div class="menu-item-left">
        <i data-lucide="trash-2" class="menu-icon"></i>
        <div class="menu-info">
          <span class="menu-label">Clear Cache</span>
          <p class="menu-description">Remove stored data</p>
        </div>
      </div>
      <i data-lucide="chevron-right" class="menu-icon"></i>
    </button>
  </div>

  <!-- Footer -->
  <div class="menu-footer">
    <p>NoorPlus v1.2.0 • Build 2026</p>
  </div>

  <!-- Prayer Settings Modal -->
  <div id="prayer-settings-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">

      <!-- Modal Header -->
      <div
        style="padding: 20px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
        <h2 style="margin: 0; font-size: 20px; font-weight: 700;">Prayer Settings</h2>
        <button id="close-settings-modal"
          style="background: none; border: none; cursor: pointer; padding: 4px; color: var(--text-secondary);">
          <i data-lucide="x"></i>
        </button>
      </div>

      <!-- Modal Body -->
      <div style="padding: 24px; overflow-y: auto; flex: 1;">

        <!-- Section: Location -->
        <h3
          style="font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-secondary); margin-bottom: 12px; margin-top: 0; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="map-pin" style="width: 16px; height: 16px;"></i> Location
        </h3>
        <div style="margin-bottom: 24px;">
          <label style="display: block; margin-bottom: 8px; font-weight: 500;">Your City</label>
          <div style="display: flex; gap: 8px;">
            <input type="text" id="settings-location-input" class="onb-input"
              placeholder="Enter city or use auto-detect" style="flex: 1;">
            <button id="settings-location-detect-btn" class="onb-btn-icon" style="padding: 10px;" title="Auto Detect">
              <i data-lucide="navigation" style="width: 20px; height: 20px;"></i>
            </button>
          </div>
          <small style="display: block; margin-top: 4px; color: var(--text-secondary);">Current: <span
              id="current-location">Not set</span></small>
        </div>

        <div style="height: 1px; background: var(--border-color); margin-bottom: 24px;"></div>

        <!-- Section: Calculation -->
        <h3
          style="font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-secondary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="calculator" style="width: 16px; height: 16px;"></i> Calculation
        </h3>

        <!-- Method -->
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 8px; font-weight: 500;">Calculation Method</label>
          <select id="settings-calculation-method" class="onb-select">
            <option value="Karachi">Karachi (Shafi)</option>
            <option value="ISNA">ISNA (North American)</option>
            <option value="MWL">Muslim World League</option>
            <option value="Makkah">Umm Al-Qura (Makkah)</option>
            <option value="Egypt">Egyptian Authority</option>
            <option value="Tehran">Tehran (Jafari)</option>
            <option value="Dubai">Dubai (Gulf)</option>
            <option value="Kuwait">Kuwait</option>
            <option value="Qatar">Qatar</option>
            <option value="Singapore">Singapore</option>
            <option value="Turkey">Turkey</option>
          </select>
        </div>

        <!-- Asr -->
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 8px; font-weight: 500;">Asr Juristic Method</label>
          <div style="background: var(--bg-secondary); padding: 4px; border-radius: 8px; display: flex;">
            <label style="flex: 1; text-align: center; cursor: pointer; padding: 8px;">
              <input type="radio" name="settings-asr-method" value="Shafi" class="hidden-radio" checked>
              <span class="radio-tile">Standard (Shafi)</span>
            </label>
            <label style="flex: 1; text-align: center; cursor: pointer; padding: 8px;">
              <input type="radio" name="settings-asr-method" value="Hanafi" class="hidden-radio">
              <span class="radio-tile">Hanafi</span>
            </label>
          </div>
          <style>
            .hidden-radio {
              display: none;
            }

            .radio-tile {
              display: block;
              padding: 8px;
              border-radius: 6px;
              font-weight: 500;
              color: var(--text-secondary);
              transition: 0.2s;
            }

            .hidden-radio:checked+.radio-tile {
              background: var(--bg-primary);
              color: var(--text-primary);
              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
          </style>
        </div>

        <!-- High Latitude -->
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 8px; font-weight: 500;">High Latitude Rule</label>
          <select id="settings-high-lat" class="onb-select">
            <option value="0">None (Default)</option>
            <option value="1">Midnight (Recommended for UK/Canada)</option>
            <option value="2">One Seventh</option>
            <option value="3">Angle Based</option>
          </select>
          <small style="color: var(--text-muted);">Fixes missing prayers in summer for high latitudes.</small>
        </div>

        <div style="height: 1px; background: var(--border-color); margin-bottom: 24px;"></div>

        <!-- Section: Adjustments -->
        <h3
          style="font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-secondary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="calendar-clock" style="width: 16px; height: 16px;"></i> Adjustments
        </h3>

        <!-- Hijri -->
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 8px; font-weight: 500;">Hijri Date (+/- Days)</label>
          <div style="display: flex; align-items: center; gap: 12px;">
            <button type="button" onclick="document.getElementById('settings-hijri-adj').stepDown()"
              style="width: 40px; height: 40px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-secondary); cursor: pointer;">-</button>
            <input type="number" id="settings-hijri-adj" class="onb-input" min="-2" max="2" value="0"
              style="text-align: center; font-weight: bold; width: 60px;">
            <button type="button" onclick="document.getElementById('settings-hijri-adj').stepUp()"
              style="width: 40px; height: 40px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-secondary); cursor: pointer;">+</button>
          </div>
        </div>

      </div>

      <!-- Modal Footer -->
      <div style="padding: 20px; border-top: 1px solid var(--border-color);">
        <button id="save-prayer-settings"
          style="width: 100%; padding: 14px; background: var(--accent); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: 0.2s;">
          Save Changes
        </button>
      </div>

    </div>
    <!-- Notification Settings Modal -->
    <div id="notification-settings-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">

        <!-- Modal Header -->
        <div
          style="padding: 20px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
          <h2 style="margin: 0; font-size: 20px; font-weight: 700;">Adhan & Alerts</h2>
          <button id="close-notif-modal"
            style="background: none; border: none; cursor: pointer; padding: 4px; color: var(--text-secondary);">
            <i data-lucide="x"></i>
          </button>
        </div>

        <!-- Modal Body -->
        <div style="padding: 24px;">

          <!-- Master Toggle -->
          <div
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid var(--border-color);">
            <div>
              <span style="font-weight: 600; font-size: 16px; display: block;">Enable Notifications</span>
              <small style="color: var(--text-muted);">Play Adhan when time arrives</small>
            </div>
            <label class="toggle-switch-label"
              style="position: relative; display: inline-block; width: 44px; height: 24px;">
              <!-- Using the same structure as theme toggle -->
              <input type="checkbox" id="notif-master-toggle" style="opacity: 0; width: 0; height: 0;">
              <span class="custom-toggle"
                style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--divider); transition: .4s; border-radius: 34px;"></span>
              <span class="toggle-knob"
                style="position: absolute; content: ''; height: 20px; width: 20px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></span>
            </label>
          </div>

          <!-- Individual Prayers -->
          <h3 style="font-size: 13px; text-transform: uppercase; color: var(--text-secondary); margin-bottom: 16px;">
            Customize Prayers</h3>
          <div class="notif-list" style="display: flex; flex-direction: column; gap: 12px;">
            <!-- Fajr -->
            <label
              style="display: flex; justify-content: space-between; padding: 12px; background: var(--surface); border-radius: 12px; cursor: pointer;">
              <span>Fajr</span>
              <input type="checkbox" data-prayer="Fajr" class="notif-checkbox">
            </label>
            <!-- Dhuhr -->
            <label
              style="display: flex; justify-content: space-between; padding: 12px; background: var(--surface); border-radius: 12px; cursor: pointer;">
              <span>Dhuhr</span>
              <input type="checkbox" data-prayer="Dhuhr" class="notif-checkbox">
            </label>
            <!-- Asr -->
            <label
              style="display: flex; justify-content: space-between; padding: 12px; background: var(--surface); border-radius: 12px; cursor: pointer;">
              <span>Asr</span>
              <input type="checkbox" data-prayer="Asr" class="notif-checkbox">
            </label>
            <!-- Maghrib -->
            <label
              style="display: flex; justify-content: space-between; padding: 12px; background: var(--surface); border-radius: 12px; cursor: pointer;">
              <span>Maghrib</span>
              <input type="checkbox" data-prayer="Maghrib" class="notif-checkbox">
            </label>
            <!-- Isha -->
            <label
              style="display: flex; justify-content: space-between; padding: 12px; background: var(--surface); border-radius: 12px; cursor: pointer;">
              <span>Isha</span>
              <input type="checkbox" data-prayer="Isha" class="notif-checkbox">
            </label>
          </div>

        </div>

        <!-- Footer -->
        <div style="padding: 20px; border-top: 1px solid var(--border-color);">
          <button id="save-notif-settings"
            style="width: 100%; padding: 14px; background: var(--accent); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer;">
            Save Preferences
          </button>
        </div>

      </div>
    </div>

    <style>
      /* Toggle Styles for Modal */
      #notif-master-toggle:checked+.custom-toggle {
        background-color: var(--success);
      }

      #notif-master-toggle:checked+.custom-toggle .toggle-knob {
        transform: translateX(20px);
      }

      .notif-checkbox {
        width: 20px;
        height: 20px;
        accent-color: var(--primary);
      }
    </style>